name: Bot de Actualizaci贸n Diaria SMS

on:
  schedule:
    # Se ejecuta todos los d铆as a las 03:01 UTC (00:01 Hora Chile Continental)
    - cron: '1 3 * * *'
  workflow_dispatch: # Bot贸n manual para probarlo cuando quieras

jobs:
  actualizar-datos:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout del c贸digo
        uses: actions/checkout@v3

      - name: Configurar Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'
          
      - name: Instalar librer铆as (Pandas, Requests, openpyxl, bs4)
        run: pip install pandas openpyxl requests beautifulsoup4 lxml

      - name: Ejecutar script de actualizaci贸n (El Bot Ninja)
        run: python update_data.py
        env:
          # Aqu铆 inyectamos tus secretos de forma segura
          SMS_USER: ${{ secrets.SMS_USER }}
          SMS_PASS: ${{ secrets.SMS_PASS }}

      - name: Subir el Excel actualizado de vuelta al repositorio
        run: |
          git config --global user.name 'Bot SMS Analytics'
          git config --global user.email 'bot@tudominio.com'
          git add datos/reporte_actual.xlsx
          git commit -m " Actualizaci贸n autom谩tica: Datos del d铆a anterior" || echo "Sin cambios nuevos para guardar"
          git push
